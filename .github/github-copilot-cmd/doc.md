# /doc â€” AgrÃ©gateur de CHANGENOTES vers Documentation

## Description

AgrÃ¨ge les fichiers CHANGENOTES/ en un CHANGELOG.md unifiÃ©. Peut versionner la documentation et archiver les notes traitÃ©es.

## Allowed Tools

- `read_file` â€” Lire les CHANGENOTES et le CHANGELOG existant
- `list_dir` â€” Lister les fichiers dans CHANGENOTES/
- `create_file` â€” CrÃ©er/mettre Ã  jour CHANGELOG.md et archives
- `run_in_terminal` â€” Supprimer les CHANGENOTES traitÃ©es

## Validation

Avant exÃ©cution, vÃ©rifier :

1. [ ] Le dossier `CHANGENOTES/` existe
2. [ ] Il contient au moins un fichier `.md`
3. [ ] Si vide â†’ exit silencieux

## Context

Collecter ces informations :

```bash
ls CHANGENOTES/               # Liste des notes Ã  traiter
cat CHANGELOG.md              # Contenu existant (si prÃ©sent)
```

## Workflow

> âš ï¸ **IMPORTANT** : Tous les fichiers gÃ©nÃ©rÃ©s (`CHANGENOTES/`, `CHANGELOG.md`, `docs/versions/`) sont Ã  la **racine du projet**, PAS dans `.github/`

### 1. Collecter les CHANGENOTES

- Lister tous les fichiers dans `<project-root>/CHANGENOTES/`
- Les trier par date (ordre chronologique du nom de fichier)
- Parser le frontmatter YAML de chaque fichier

### 2. Grouper par type

Regrouper les notes par type de commit :

| Emoji | Section | Types |
|-------|---------|-------|
| ğŸš€ | **Features** | `feat` |
| ğŸ› | **Bug Fixes** | `fix` |
| ğŸ”„ | **Updates** | `update` |
| â™»ï¸ | **Refactoring** | `refactor` |
| ğŸ“ | **Documentation** | `docs` |
| ğŸ§ª | **Tests** | `test` |
| ğŸ”§ | **Chores** | `chore` |

### 3. GÃ©nÃ©rer/Mettre Ã  jour CHANGELOG.md

**Structure du CHANGELOG** :
```markdown
# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]

### ğŸš€ Features
- **scope:** description (hash)

### ğŸ› Bug Fixes
- **scope:** description (hash)

...

## [1.0.0] - 2025-12-01

### ğŸš€ Features
- ...
```

**Si pas de version demandÃ©e** :
- Ajouter/mettre Ã  jour la section `## [Unreleased]` en haut
- Lister les changements groupÃ©s par type

**Si version demandÃ©e** :
- Remplacer `[Unreleased]` par `[X.Y.Z] - YYYY-MM-DD`
- CrÃ©er une nouvelle section `[Unreleased]` vide au-dessus

### 4. Archiver (si version)

Si une version est crÃ©Ã©e :
- CrÃ©er `docs/versions/vX.Y.Z.md` avec le contenu de cette version
- Contient uniquement les changements de cette version

### 5. Nettoyer les CHANGENOTES

- **Par dÃ©faut** : supprimer tous les fichiers traitÃ©s dans `CHANGENOTES/`
- **Si `--keep`** : conserver les fichiers

## Rules

1. **EMPLACEMENT RACINE** â€” `CHANGENOTES/`, `CHANGELOG.md`, `docs/versions/` sont Ã  la racine du projet (jamais dans `.github/`)
2. **Ordre chronologique** â€” CHANGENOTES triÃ©es par date (plus rÃ©cent en haut)
3. **Groupement par type** â€” Sections claires avec emojis
4. **Idempotent** â€” Relancer sans CHANGENOTES = no-op silencieux
5. **Pas de duplicata** â€” Ne pas rÃ©-ajouter des entrÃ©es existantes (vÃ©rifier hash)
6. **Format Keep a Changelog** â€” Respecter le standard https://keepachangelog.com
7. **NO verbose** â€” Messages concis uniquement
8. **NO interactive** â€” Pas de confirmation demandÃ©e
9. **NO signature** â€” Pas de "Generated by..."

## Arguments

```
/doc $ARGUMENTS
```

| Argument | Description |
|----------|-------------|
| (vide) | AgrÃ¨ge vers [Unreleased], supprime CHANGENOTES |
| `version` | AgrÃ¨ge + incrÃ©mente patch (1.0.0 â†’ 1.0.1) |
| `version X.Y.Z` | AgrÃ¨ge + force version X.Y.Z |
| `--keep` ou `-k` | Ne supprime pas les CHANGENOTES |
| `--dry-run` ou `-d` | Preview sans modification |
| `--help` ou `-h` | Affiche l'aide de la commande |

**Combinaisons possibles** :
- `/doc` â€” AgrÃ¨ge et nettoie
- `/doc version` â€” Release avec auto-increment
- `/doc version 2.0.0` â€” Release forcÃ©e
- `/doc --keep` â€” AgrÃ¨ge sans supprimer
- `/doc version --dry-run` â€” Preview release

## Execution

- **NO interactive commands** â€” Pas de confirmation
- **NO verbose messages** â€” Juste le rÃ©sultat
- **NO "Generated by..." signatures**
- **If nothing to do** â†’ exit silently
- **If error** â†’ report concisely

## Output Format

**Mode normal** :
```
âœ“ CHANGELOG.md updated [Unreleased] (+5 entries)
  âœ— CHANGENOTES/ cleared (5 files)
```

**Mode version** :
```
âœ“ CHANGELOG.md updated [1.2.0] - 2025-12-11 (+5 entries)
  â†’ docs/versions/v1.2.0.md created
  âœ— CHANGENOTES/ cleared (5 files)
```

**Mode --keep** :
```
âœ“ CHANGELOG.md updated [Unreleased] (+5 entries)
  âŠ™ CHANGENOTES/ kept (5 files)
```

**Mode dry-run** :
```
â” Would update CHANGELOG.md [Unreleased] (+5 entries)
  - feat(auth): add login validation
  - fix(api): handle timeout errors
  - docs(readme): update installation guide
```

**Rien Ã  faire** :
```
(exit silencieux, pas de message)
```
